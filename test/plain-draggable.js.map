{"version":3,"sources":["webpack:///webpack/bootstrap ba6a657d8ae990b29d94","webpack:///./src/plain-draggable.js","webpack:///./node_modules/cssprefix/src/cssprefix.js","webpack:///./node_modules/anim-event/src/anim-event.js","webpack:///./node_modules/m-class-list/src/m-class-list.js"],"names":["ignoreNative","ZINDEX","SNAP_GRAVITY","SNAP_CORNER","SNAP_SIDE","SNAP_EDGE","SNAP_BASE","SNAP_ALL_CORNERS","SNAP_ALL_SIDES","SNAP_ALL_EDGES","IS_WEBKIT","window","chrome","document","documentElement","style","IS_GECKO","isObject","toString","fnToString","hasOwnProperty","objFnString","call","Object","proto","constr","obj","getPrototypeOf","constructor","isFinite","Number","value","insProps","insId","activeItem","hasMoved","pointerOffset","body","cssValueDraggableCursor","cssValueDraggingCursor","cssOrgValueBodyCursor","cssPropTransform","cssPropUserSelect","cssOrgValueBodyUserSelect","cssWantedValueDraggableCursor","cssWantedValueDraggingCursor","draggableClass","draggingClass","movingClass","copyTree","keys","reduce","copyObj","key","Array","isArray","map","hasChanged","a","b","typeA","keysA","sort","some","prop","length","aVal","i","isElement","element","nodeType","Node","ELEMENT_NODE","getBoundingClientRect","compareDocumentPosition","DOCUMENT_POSITION_DISCONNECTED","validBBox","bBox","left","x","top","y","width","right","height","bottom","validPPValue","string2PPValue","inString","matches","exec","isRatio","parseFloat","replace","ppValue2OptionValue","ppValue","resolvePPValue","baseOrigin","baseSize","validPPBBox","ppBBox2OptionObject","ppBBox","resolvePPBBox","baseBBox","prop2Axis","baseOriginXY","baseSizeXY","getBBox","getPaddingBox","rect","pageXOffset","pageYOffset","getComputedStyle","borderTop","borderTopWidth","borderRight","borderRightWidth","borderBottom","borderBottomWidth","borderLeft","borderLeftWidth","initAnim","gpuTrigger","webkitTapHighlightColor","cssPropBoxShadow","getName","boxShadow","setDraggableCursor","orgCursor","getValue","cursor","setDraggingCursor","viewPoint2SvgPoint","props","clientX","clientY","svgPoint","matrixTransform","svgCtmElement","getScreenCTM","inverse","moveTranslate","position","elementBBox","offset","htmlOffset","elementStyle","moveLeftTop","moved","moveSvg","svgOffset","originBBox","svgOriginBBox","point","svgTransform","setTranslate","move","cbCheck","fix","minLeft","maxLeft","minTop","maxTop","moveElm","initTranslate","curPosition","RESTORE_PROPS","unshift","orgStyle","lastStyle","forEach","orgSize","cmpStyle","display","padding","dirProp","newBBox","initLeftTop","margin","initSvg","curRect","newRect","originPoint","curPoint","initBBox","initElm","docBBox","containmentBBox","containmentIsBBox","options","containment","parsedSnapTargets","elementSizeXY","minXY","maxXY","xStart","xEnd","xStep","yStart","yEnd","yStep","snapTargets","parsedSnapTarget","baseRect","base","addSnapTarget","targetXY","center","xGravity","gravity","yGravity","corners","corner","snapTarget","gravityXStart","gravityXEnd","gravityYStart","gravityYEnd","push","specAxis","rangeAxis","startProp","endProp","gravityProp","specAxisL","toUpperCase","rangeAxisL","gravitySpecStartProp","gravitySpecEndProp","gravityRangeStartProp","gravityRangeEndProp","sides","xy","side","gravitySpecStart","gravitySpecEnd","edges","lengthenX","lengthenY","edge","expanded","axis","stepProp","start","end","step","curValue","expandedXY","initBBoxDone","dragEnd","handle","zIndex","orgZIndex","classList","remove","onDragEnd","mousedown","event","disabled","add","pageX","pageY","setOptions","newOptions","needsInitBBox","scrollElements","removeEventListener","handleScroll","fixedElement","SVGElement","overflow","overflowX","overflowY","addEventListener","parentNode","commonSnapOptions","cleanString","trim","toLowerCase","added","split","cornersLen","join","snap","newSnapOptions","targets","snapTargetsOptions","snapOptions","target","isElementPre","ppBBoxPre","newSnapTargetOptions","boundingBox","expandedParsedSnapTargets","snapTargetOptions","newOptionsBBox","invalid","parsedXY","newOptionsXY","commonOptions","option","dragstart","preventDefault","orgUserSelect","handleMousedown","needsMove","bind","ins","PlainDraggable","defineProperty","_id","initArguments","prototype","slice","arguments","Error","ownerSvg","ownerSVGElement","transform","baseVal","appendItem","createSVGTransform","createSVGPoint","svgView","nearestViewportElement","appendChild","createElementNS","namespaceURI","cssPropWillChange","leftTop","parent","onDrag","onMove","onMoveStart","id","snappedX","snappedY","iLen","snapped","initDoc","resizing","console","log","ucf","text","substr","PREFIXES","NAME_PREFIXES","prefixes","prefix","VALUE_PREFIXES","getDeclaration","declaration","createElement","normalizeName","rePrefixedName","RegExp","reUc","propName","str","p1","test","normalizeValue","rePrefixedValue","propValue","cssSupports","setProperty","getPropertyValue","propNames","propValues","getNameDone","ucfName","prefixed","res","getValueDone","CSSPrefix","MSPF","KEEP_LOOP","tasks","requestAnim","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","setTimeout","callback","cancelAnim","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","msCancelAnimationFrame","clearTimeout","requestID","lastFrameTime","Date","now","requestAnimSave","cancelAnimSave","AnimEventByTimer","byTimer","called","next","task","listener","indexOfTasks","index","AnimEvent","iRemove","splice","normalize","token","applyList","list","setAttribute","tokens","filter","indexOf","toggle","force","newToken","mClassList","getAttribute","item","contains","methodChain"],"mappings":"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","file":"plain-draggable.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ba6a657d8ae990b29d94","/*\n * PlainDraggable\n * https://anseki.github.io/plain-draggable/\n *\n * Copyright (c) 2018 anseki\n * Licensed under the MIT license.\n */\n\nimport CSSPrefix from 'cssprefix';\nimport AnimEvent from 'anim-event';\nimport mClassList from 'm-class-list';\nmClassList.ignoreNative = true;\n\nconst\n  ZINDEX = 9000,\n  // [SNAP]\n  SNAP_GRAVITY = 20, SNAP_CORNER = 'tl', SNAP_SIDE = 'both', SNAP_EDGE = 'both', SNAP_BASE = 'containment',\n  SNAP_ALL_CORNERS = ['tl', 'tr', 'bl', 'br'],\n  SNAP_ALL_SIDES = ['start', 'end'],\n  SNAP_ALL_EDGES = ['inside', 'outside'],\n  // [/SNAP]\n\n  IS_WEBKIT = !window.chrome && 'WebkitAppearance' in document.documentElement.style,\n  IS_GECKO = 'MozAppearance' in document.documentElement.style, // [SVG/]\n\n  isObject = (() => {\n    const toString = {}.toString, fnToString = {}.hasOwnProperty.toString,\n      objFnString = fnToString.call(Object);\n    return obj => {\n      let proto, constr;\n      return obj && toString.call(obj) === '[object Object]' &&\n        (!(proto = Object.getPrototypeOf(obj)) ||\n          (constr = proto.hasOwnProperty('constructor') && proto.constructor) &&\n          typeof constr === 'function' && fnToString.call(constr) === objFnString);\n    };\n  })(),\n  isFinite = Number.isFinite || (value => typeof value === 'number' && window.isFinite(value)),\n\n  /** @type {Object.<_id: number, props>} */\n  insProps = {};\n\nlet insId = 0,\n  activeItem, hasMoved, pointerOffset, body,\n  // CSS property/value\n  cssValueDraggableCursor, cssValueDraggingCursor, cssOrgValueBodyCursor,\n  cssPropTransform, cssPropUserSelect, cssOrgValueBodyUserSelect,\n  // Try to set `cursor` property.\n  cssWantedValueDraggableCursor = IS_WEBKIT ? ['all-scroll', 'move'] : ['grab', 'all-scroll', 'move'],\n  cssWantedValueDraggingCursor = IS_WEBKIT ? 'move' : ['grabbing', 'move'],\n  // class\n  draggableClass = 'plain-draggable',\n  draggingClass = 'plain-draggable-dragging', movingClass = 'plain-draggable-moving';\n\n// [DEBUG]\nwindow.insProps = insProps;\nwindow.IS_WEBKIT = IS_WEBKIT;\nwindow.IS_GECKO = IS_GECKO; // [SVG/]\n// [SNAP]\nwindow.SNAP_GRAVITY = SNAP_GRAVITY;\nwindow.SNAP_CORNER = SNAP_CORNER;\nwindow.SNAP_SIDE = SNAP_SIDE;\nwindow.SNAP_EDGE = SNAP_EDGE;\nwindow.SNAP_BASE = SNAP_BASE;\nwindow.SNAP_ALL_CORNERS = SNAP_ALL_CORNERS;\nwindow.SNAP_ALL_SIDES = SNAP_ALL_SIDES;\nwindow.SNAP_ALL_EDGES = SNAP_ALL_EDGES;\n// [/SNAP]\n// [/DEBUG]\n\nfunction copyTree(obj) {\n  return !obj ? obj :\n    isObject(obj) ? Object.keys(obj).reduce((copyObj, key) => {\n      copyObj[key] = copyTree(obj[key]);\n      return copyObj;\n    }, {}) :\n    Array.isArray(obj) ? obj.map(copyTree) : obj;\n}\n\nfunction hasChanged(a, b) {\n  let typeA, keysA;\n  return typeof a !== typeof b ||\n    (typeA = isObject(a) ? 'obj' : Array.isArray(a) ? 'array' : '') !==\n      (isObject(b) ? 'obj' : Array.isArray(b) ? 'array' : '') ||\n    (\n      typeA === 'obj' ?\n        hasChanged((keysA = Object.keys(a).sort()), Object.keys(b).sort()) ||\n          keysA.some(prop => hasChanged(a[prop], b[prop])) :\n      typeA === 'array' ?\n        a.length !== b.length || a.some((aVal, i) => hasChanged(aVal, b[i])) :\n      a !== b\n    );\n}\n\n/**\n * @param {Element} element - A target element.\n * @returns {boolean} `true` if connected element.\n */\nfunction isElement(element) {\n  return !!(element &&\n    element.nodeType === Node.ELEMENT_NODE &&\n    // element instanceof HTMLElement &&\n    typeof element.getBoundingClientRect === 'function' &&\n    !(element.compareDocumentPosition(document) & Node.DOCUMENT_POSITION_DISCONNECTED));\n}\nwindow.isElement = isElement; // [DEBUG/]\n\n/**\n * An object that simulates `DOMRect` to indicate a bounding-box.\n * @typedef {Object} BBox\n * @property {(number|null)} left - document coordinate\n * @property {(number|null)} top - document coordinate\n * @property {(number|null)} right - document coordinate\n * @property {(number|null)} bottom - document coordinate\n * @property {(number|null)} x - Substitutes for left\n * @property {(number|null)} y - Substitutes for top\n * @property {(number|null)} width\n * @property {(number|null)} height\n */\n\n/**\n * @param {Object} bBox - A target object.\n * @returns {(BBox|null)} A normalized `BBox`, or null if `bBox` is invalid.\n */\nfunction validBBox(bBox) {\n  if (!isObject(bBox)) { return null; }\n  let value;\n  if (isFinite((value = bBox.left)) || isFinite((value = bBox.x))) {\n    bBox.left = bBox.x = value;\n  } else { return null; }\n  if (isFinite((value = bBox.top)) || isFinite((value = bBox.y))) {\n    bBox.top = bBox.y = value;\n  } else { return null; }\n\n  if (isFinite(bBox.width) && bBox.width >= 0) {\n    bBox.right = bBox.left + bBox.width;\n  } else if (isFinite(bBox.right) && bBox.right >= bBox.left) {\n    bBox.width = bBox.right - bBox.left;\n  } else { return null; }\n  if (isFinite(bBox.height) && bBox.height >= 0) {\n    bBox.bottom = bBox.top + bBox.height;\n  } else if (isFinite(bBox.bottom) && bBox.bottom >= bBox.top) {\n    bBox.height = bBox.bottom - bBox.top;\n  } else { return null; }\n  return bBox;\n}\nwindow.validBBox = validBBox; // [DEBUG/]\n\n/**\n * A value that is Pixels or Ratio\n * @typedef {{value: number, isRatio: boolean}} PPValue\n */\n\nfunction validPPValue(value) {\n\n  // Get PPValue from string (all `/s` were already removed)\n  function string2PPValue(inString) {\n    const matches = /^(.+?)(\\%)?$/.exec(inString);\n    let value, isRatio;\n    return matches && isFinite((value = parseFloat(matches[1]))) ?\n      {value: (isRatio = !!(matches[2] && value)) ? value / 100 : value, isRatio: isRatio} : null; // 0% -> 0\n  }\n\n  return isFinite(value) ? {value: value, isRatio: false} :\n    typeof value === 'string' ? string2PPValue(value.replace(/\\s/g, '')) : null;\n}\nwindow.validPPValue = validPPValue; // [DEBUG/]\n\nfunction ppValue2OptionValue(ppValue) {\n  return ppValue.isRatio ? `${ppValue.value * 100}%` : ppValue.value;\n}\nwindow.ppValue2OptionValue = ppValue2OptionValue; // [DEBUG/]\n\nfunction resolvePPValue(ppValue, baseOrigin, baseSize) {\n  return typeof ppValue === 'number' ? ppValue :\n    baseOrigin + ppValue.value * (ppValue.isRatio ? baseSize : 1);\n}\n\n/**\n * An object that simulates BBox but properties are PPValue.\n * @typedef {Object} PPBBox\n */\n\n/**\n * @param {Object} bBox - A target object.\n * @returns {(PPBBox|null)} A normalized `PPBBox`, or null if `bBox` is invalid.\n */\nfunction validPPBBox(bBox) {\n  if (!isObject(bBox)) { return null; }\n  let ppValue;\n  if ((ppValue = validPPValue(bBox.left)) || (ppValue = validPPValue(bBox.x))) {\n    bBox.left = bBox.x = ppValue;\n  } else { return null; }\n  if ((ppValue = validPPValue(bBox.top)) || (ppValue = validPPValue(bBox.y))) {\n    bBox.top = bBox.y = ppValue;\n  } else { return null; }\n\n  if ((ppValue = validPPValue(bBox.width)) && ppValue.value >= 0) {\n    bBox.width = ppValue;\n    delete bBox.right;\n  } else if ((ppValue = validPPValue(bBox.right))) {\n    bBox.right = ppValue;\n    delete bBox.width;\n  } else { return null; }\n  if ((ppValue = validPPValue(bBox.height)) && ppValue.value >= 0) {\n    bBox.height = ppValue;\n    delete bBox.bottom;\n  } else if ((ppValue = validPPValue(bBox.bottom))) {\n    bBox.bottom = ppValue;\n    delete bBox.height;\n  } else { return null; }\n  return bBox;\n}\nwindow.validPPBBox = validPPBBox; // [DEBUG/]\n\nfunction ppBBox2OptionObject(ppBBox) {\n  return Object.keys(ppBBox).reduce((obj, prop) => {\n    obj[prop] = ppValue2OptionValue(ppBBox[prop]);\n    return obj;\n  }, {});\n}\nwindow.ppBBox2OptionObject = ppBBox2OptionObject; // [DEBUG/]\n\n// PPBBox -> BBox\nfunction resolvePPBBox(ppBBox, baseBBox) {\n  const prop2Axis = {left: 'x', right: 'x', x: 'x', width: 'x',\n      top: 'y', bottom: 'y', y: 'y', height: 'y'},\n    baseOriginXY = {x: baseBBox.left, y: baseBBox.top},\n    baseSizeXY = {x: baseBBox.width, y: baseBBox.height};\n  return validBBox(Object.keys(ppBBox).reduce((bBox, prop) => {\n    bBox[prop] = resolvePPValue(ppBBox[prop],\n      prop === 'width' || prop === 'height' ? 0 : baseOriginXY[prop2Axis[prop]],\n      baseSizeXY[prop2Axis[prop]]);\n    return bBox;\n  }, {}));\n}\nwindow.resolvePPBBox = resolvePPBBox; // [DEBUG/]\n\n/**\n * @param {Element} element - A target element.\n * @param {?boolean} getPaddingBox - Get padding-box instead of border-box as bounding-box.\n * @returns {BBox} A bounding-box of `element`.\n */\nfunction getBBox(element, getPaddingBox) {\n  const rect = element.getBoundingClientRect(),\n    bBox = {left: rect.left, top: rect.top, width: rect.width, height: rect.height};\n  bBox.left += window.pageXOffset;\n  bBox.top += window.pageYOffset;\n  if (getPaddingBox) {\n    const style = window.getComputedStyle(element, ''),\n      borderTop = parseFloat(style.borderTopWidth) || 0,\n      borderRight = parseFloat(style.borderRightWidth) || 0,\n      borderBottom = parseFloat(style.borderBottomWidth) || 0,\n      borderLeft = parseFloat(style.borderLeftWidth) || 0;\n    bBox.left += borderLeft;\n    bBox.top += borderTop;\n    bBox.width -= borderLeft + borderRight;\n    bBox.height -= borderTop + borderBottom;\n  }\n  return validBBox(bBox);\n}\nwindow.getBBox = getBBox; // [DEBUG/]\n\n/**\n * Optimize an element for animation.\n * @param {Element} element - A target element.\n * @param {?boolean} gpuTrigger - Initialize for SVGElement if `true`.\n * @returns {Element} A target element.\n */\nfunction initAnim(element, gpuTrigger) {\n  const style = element.style;\n  style.webkitTapHighlightColor = 'transparent';\n\n  // Only when it has no shadow\n  const cssPropBoxShadow = CSSPrefix.getName('boxShadow'),\n    boxShadow = window.getComputedStyle(element, '')[cssPropBoxShadow];\n  if (!boxShadow || boxShadow === 'none') {\n    style[cssPropBoxShadow] = '0 0 1px transparent';\n  }\n\n  if (gpuTrigger && cssPropTransform) { style[cssPropTransform] = 'translateZ(0)'; }\n  return element;\n}\n\nfunction setDraggableCursor(element, orgCursor) {\n  if (cssValueDraggableCursor == null) {\n    if (cssWantedValueDraggableCursor !== false) {\n      cssValueDraggableCursor = CSSPrefix.getValue('cursor', cssWantedValueDraggableCursor);\n    }\n    // The wanted value was denied, or changing is not wanted.\n    if (cssValueDraggableCursor == null) { cssValueDraggableCursor = false; }\n  }\n  // Update it to change a state even if cssValueDraggableCursor is false.\n  element.style.cursor = cssValueDraggableCursor === false ? orgCursor : cssValueDraggableCursor;\n}\n\nfunction setDraggingCursor(element) {\n  if (cssValueDraggingCursor == null) {\n    if (cssWantedValueDraggingCursor !== false) {\n      cssValueDraggingCursor = CSSPrefix.getValue('cursor', cssWantedValueDraggingCursor);\n    }\n    // The wanted value was denied, or changing is not wanted.\n    if (cssValueDraggingCursor == null) { cssValueDraggingCursor = false; }\n  }\n  if (cssValueDraggingCursor !== false) { element.style.cursor = cssValueDraggingCursor; }\n}\n\n// [SVG]\n/**\n * Get SVG coordinates from viewport coordinates.\n * @param {props} props - `props` of instance.\n * @param {number} clientX - viewport X.\n * @param {number} clientY - viewport Y.\n * @returns {SVGPoint} SVG coordinates.\n */\nfunction viewPoint2SvgPoint(props, clientX, clientY) {\n  const svgPoint = props.svgPoint;\n  svgPoint.x = clientX;\n  svgPoint.y = clientY;\n  return svgPoint.matrixTransform(props.svgCtmElement.getScreenCTM().inverse());\n}\n// [/SVG]\n\n/**\n * Move by `translate`.\n * @param {props} props - `props` of instance.\n * @param {{left: number, top: number}} position - New position.\n * @returns {boolean} `true` if it was moved.\n */\nfunction moveTranslate(props, position) {\n  const elementBBox = props.elementBBox;\n  if (position.left !== elementBBox.left || position.top !== elementBBox.top) {\n    const offset = props.htmlOffset;\n    props.elementStyle[cssPropTransform] =\n      `translate(${position.left + offset.left}px, ${position.top + offset.top}px)`;\n    return true;\n  }\n  return false;\n}\n\n// [LEFTTOP]\n/**\n * Move by `left` and `top`.\n * @param {props} props - `props` of instance.\n * @param {{left: number, top: number}} position - New position.\n * @returns {boolean} `true` if it was moved.\n */\nfunction moveLeftTop(props, position) {\n  const elementBBox = props.elementBBox,\n    elementStyle = props.elementStyle,\n    offset = props.htmlOffset;\n  let moved = false;\n  if (position.left !== elementBBox.left) {\n    elementStyle.left = position.left + offset.left + 'px';\n    moved = true;\n  }\n  if (position.top !== elementBBox.top) {\n    elementStyle.top = position.top + offset.top + 'px';\n    moved = true;\n  }\n  return moved;\n}\n// [/LEFTTOP]\n\n// [SVG]\n/**\n * Move SVGElement.\n * @param {props} props - `props` of instance.\n * @param {{left: number, top: number}} position - New position.\n * @returns {boolean} `true` if it was moved.\n */\nfunction moveSvg(props, position) {\n  const elementBBox = props.elementBBox;\n  if (position.left !== elementBBox.left || position.top !== elementBBox.top) {\n    const offset = props.svgOffset, originBBox = props.svgOriginBBox,\n      point = viewPoint2SvgPoint(props,\n        position.left - window.pageXOffset, position.top - window.pageYOffset);\n    props.svgTransform.setTranslate(point.x + offset.x - originBBox.x, point.y + offset.y - originBBox.y);\n    return true;\n  }\n  return false;\n}\n// [/SVG]\n\n/**\n * Set `props.element` position.\n * @param {props} props - `props` of instance.\n * @param {{left: number, top: number}} position - New position.\n * @param {function} [cbCheck] - Callback that is called with valid position, cancel moving if it returns `false`.\n * @returns {boolean} `true` if it was moved.\n */\nfunction move(props, position, cbCheck) {\n  const elementBBox = props.elementBBox;\n\n  function fix() {\n    if (props.minLeft >= props.maxLeft) { // Disabled\n      position.left = elementBBox.left;\n    } else if (position.left < props.minLeft) {\n      position.left = props.minLeft;\n    } else if (position.left > props.maxLeft) {\n      position.left = props.maxLeft;\n    }\n    if (props.minTop >= props.maxTop) { // Disabled\n      position.top = elementBBox.top;\n    } else if (position.top < props.minTop) {\n      position.top = props.minTop;\n    } else if (position.top > props.maxTop) {\n      position.top = props.maxTop;\n    }\n  }\n\n  fix();\n  if (cbCheck) {\n    if (cbCheck(position) === false) { return false; }\n    fix(); // Again\n  }\n\n  const moved = props.moveElm(props, position);\n  if (moved) { // Update elementBBox\n    props.elementBBox = validBBox({left: position.left, top: position.top,\n      width: elementBBox.width, height: elementBBox.height});\n  }\n  return moved;\n}\n\n/**\n * Initialize HTMLElement for `translate`, and get `offset` that is used by `moveTranslate`.\n * @param {props} props - `props` of instance.\n * @returns {void}\n */\nfunction initTranslate(props) {\n  const element = props.element,\n    elementStyle = props.elementStyle,\n    curPosition = getBBox(element), // Get BBox before change style.\n    RESTORE_PROPS = ['display', 'marginTop', 'marginBottom', 'width', 'height'];\n  RESTORE_PROPS.unshift(cssPropTransform);\n\n  if (!props.orgStyle) {\n    props.orgStyle = RESTORE_PROPS.reduce((orgStyle, prop) => {\n      orgStyle[prop] = elementStyle[prop] || '';\n      return orgStyle;\n    }, {});\n    props.lastStyle = {};\n  } else {\n    RESTORE_PROPS.forEach(prop => {\n      // Skip this if it seems user changed it. (it can't check perfectly.)\n      if (props.lastStyle[prop] == null || elementStyle[prop] === props.lastStyle[prop]) {\n        elementStyle[prop] = props.orgStyle[prop];\n      }\n    });\n  }\n\n  const orgSize = getBBox(element),\n    cmpStyle = window.getComputedStyle(element, '');\n  // https://www.w3.org/TR/css-transforms-1/#transformable-element\n  if (cmpStyle.display === 'inline') {\n    elementStyle.display = 'inline-block';\n    ['Top', 'Bottom'].forEach(dirProp => {\n      const padding = parseFloat(cmpStyle[`padding${dirProp}`]);\n      // paddingTop/Bottom make padding but don't make space -> negative margin in inline-block\n      // marginTop/Bottom don't work in inline element -> `0` in inline-block\n      elementStyle[`margin${dirProp}`] = padding ? `-${padding}px` : '0';\n    });\n  }\n  elementStyle[cssPropTransform] = 'translate(0, 0)';\n  // Get document offset.\n  let newBBox = getBBox(element);\n  const offset = props.htmlOffset =\n    {left: newBBox.left ? -newBBox.left : 0, top: newBBox.top ? -newBBox.top : 0}; // avoid `-0`\n\n  // Restore position\n  elementStyle[cssPropTransform] =\n    `translate(${curPosition.left + offset.left}px, ${curPosition.top + offset.top}px)`;\n  // Restore size\n  ['width', 'height'].forEach(prop => {\n    if (newBBox[prop] !== orgSize[prop]) {\n      // Ignore `box-sizing`\n      elementStyle[prop] = orgSize[prop] + 'px';\n      newBBox = getBBox(element);\n      if (newBBox[prop] !== orgSize[prop]) { // Retry\n        elementStyle[prop] = orgSize[prop] - (newBBox[prop] - orgSize[prop]) + 'px';\n      }\n    }\n    props.lastStyle[prop] = elementStyle[prop];\n  });\n}\n\n// [LEFTTOP]\n/**\n * Initialize HTMLElement for `left` and `top`, and get `offset` that is used by `moveLeftTop`.\n * @param {props} props - `props` of instance.\n * @returns {void}\n */\nfunction initLeftTop(props) {\n  const element = props.element,\n    elementStyle = props.elementStyle,\n    curPosition = getBBox(element), // Get BBox before change style.\n    RESTORE_PROPS = ['position', 'marginTop', 'marginRight', 'marginBottom', 'marginLeft', 'width', 'height'];\n\n  if (!props.orgStyle) {\n    props.orgStyle = RESTORE_PROPS.reduce((orgStyle, prop) => {\n      orgStyle[prop] = elementStyle[prop] || '';\n      return orgStyle;\n    }, {});\n    props.lastStyle = {};\n  } else {\n    RESTORE_PROPS.forEach(prop => {\n      // Skip this if it seems user changed it. (it can't check perfectly.)\n      if (props.lastStyle[prop] == null || elementStyle[prop] === props.lastStyle[prop]) {\n        elementStyle[prop] = props.orgStyle[prop];\n      }\n    });\n  }\n\n  const orgSize = getBBox(element);\n  elementStyle.position = 'absolute';\n  elementStyle.left = elementStyle.top = elementStyle.margin = '0';\n  // Get document offset.\n  let newBBox = getBBox(element);\n  const offset = props.htmlOffset =\n    {left: newBBox.left ? -newBBox.left : 0, top: newBBox.top ? -newBBox.top : 0}; // avoid `-0`\n\n  // Restore position\n  elementStyle.left = curPosition.left + offset.left + 'px';\n  elementStyle.top = curPosition.top + offset.top + 'px';\n  // Restore size\n  ['width', 'height'].forEach(prop => {\n    if (newBBox[prop] !== orgSize[prop]) {\n      // Ignore `box-sizing`\n      elementStyle[prop] = orgSize[prop] + 'px';\n      newBBox = getBBox(element);\n      if (newBBox[prop] !== orgSize[prop]) { // Retry\n        elementStyle[prop] = orgSize[prop] - (newBBox[prop] - orgSize[prop]) + 'px';\n      }\n    }\n    props.lastStyle[prop] = elementStyle[prop];\n  });\n}\n// [/LEFTTOP]\n\n// [SVG]\n/**\n * Initialize SVGElement, and get `offset` that is used by `moveSvg`.\n * @param {props} props - `props` of instance.\n * @returns {void}\n */\nfunction initSvg(props) {\n  const element = props.element,\n    svgTransform = props.svgTransform,\n    curRect = element.getBoundingClientRect(); // Get Rect before change position.\n\n  svgTransform.setTranslate(0, 0);\n  const originBBox = props.svgOriginBBox = element.getBBox(),\n    // Try to get SVG coordinates of current position.\n    newRect = element.getBoundingClientRect(),\n    originPoint = viewPoint2SvgPoint(props, newRect.left, newRect.top),\n    // Gecko bug, getScreenCTM returns incorrect CTM, and originPoint might not be current position.\n    offset = props.svgOffset = {x: originBBox.x - originPoint.x, y: originBBox.y - originPoint.y},\n\n    // Restore position\n    curPoint = viewPoint2SvgPoint(props, curRect.left, curRect.top);\n  svgTransform.setTranslate(curPoint.x + offset.x - originBBox.x, curPoint.y + offset.y - originBBox.y);\n}\n// [/SVG]\n\n/**\n * Set `elementBBox`, `containmentBBox`, `min/max``Left/Top` and `snapTargets`.\n * @param {props} props - `props` of instance.\n * @returns {void}\n */\nfunction initBBox(props) {\n  props.initElm(props);\n\n  const docBBox = getBBox(document.documentElement),\n    elementBBox = props.elementBBox = getBBox(props.element),\n    containmentBBox = props.containmentBBox =\n      props.containmentIsBBox ? (resolvePPBBox(props.options.containment, docBBox) || docBBox) :\n        getBBox(props.options.containment, true);\n  props.minLeft = containmentBBox.left;\n  props.maxLeft = containmentBBox.right - elementBBox.width;\n  props.minTop = containmentBBox.top;\n  props.maxTop = containmentBBox.bottom - elementBBox.height;\n  // Adjust position\n  move(props, {left: elementBBox.left, top: elementBBox.top});\n\n  // [SNAP]\n\n  // Snap-targets\n\n  /**\n   * @typedef {Object} SnapTarget\n   * @property {number} [x] - A coordinate it moves to. It has x or y or both.\n   * @property {number} [y]\n   * @property {number} [gravityXStart] - Gravity zone. It has *Start or *End or both, and *X* or *Y* or both.\n   * @property {number} [gravityXEnd]\n   * @property {number} [gravityYStart]\n   * @property {number} [gravityYEnd]\n   */\n\n  if (props.parsedSnapTargets) {\n    const elementSizeXY = {x: elementBBox.width, y: elementBBox.height},\n      minXY = {x: props.minLeft, y: props.minTop}, maxXY = {x: props.maxLeft, y: props.maxTop},\n      prop2Axis = {left: 'x', right: 'x', x: 'x', width: 'x', xStart: 'x', xEnd: 'x', xStep: 'x',\n        top: 'y', bottom: 'y', y: 'y', height: 'y', yStart: 'y', yEnd: 'y', yStep: 'y'},\n\n      snapTargets = props.parsedSnapTargets.reduce((snapTargets, parsedSnapTarget) => {\n        const baseRect = parsedSnapTarget.base === 'containment' ? containmentBBox : docBBox,\n          baseOriginXY = {x: baseRect.left, y: baseRect.top},\n          baseSizeXY = {x: baseRect.width, y: baseRect.height};\n\n        /**\n         * Basically, shallow copy from parsedSnapTarget, and it can have resolved values.\n         * @typedef {{x: (number|PPValue), y, xStart, xEnd, xStep, yStart, yEnd, yStep}} TargetXY\n         * @property {string[]} [corners] - Applied value.\n         * @property {string[]} [sides]\n         * @property {boolean} center\n         * @property {number} [xGravity] - Override parsedSnapTarget.gravity.\n         * @property {number} [yGravity]\n         */\n\n        // Add single Point or Line (i.e. targetXY has no *Step)\n        function addSnapTarget(targetXY) {\n          if (targetXY.center == null) { targetXY.center = parsedSnapTarget.center; }\n          if (targetXY.xGravity == null) { targetXY.xGravity = parsedSnapTarget.gravity; }\n          if (targetXY.yGravity == null) { targetXY.yGravity = parsedSnapTarget.gravity; }\n\n          if (targetXY.x != null && targetXY.y != null) { // Point\n            targetXY.x = resolvePPValue(targetXY.x, baseOriginXY.x, baseSizeXY.x);\n            targetXY.y = resolvePPValue(targetXY.y, baseOriginXY.y, baseSizeXY.y);\n\n            if (targetXY.center) {\n              targetXY.x -= elementSizeXY.x / 2;\n              targetXY.y -= elementSizeXY.y / 2;\n              targetXY.corners = ['tl'];\n            }\n\n            (targetXY.corners || parsedSnapTarget.corners).forEach(corner => {\n              const x = targetXY.x - (corner === 'tr' || corner === 'br' ? elementSizeXY.x : 0),\n                y = targetXY.y - (corner === 'bl' || corner === 'br' ? elementSizeXY.y : 0);\n              if (x >= minXY.x && x <= maxXY.x && y >= minXY.y && y <= maxXY.y) {\n                const snapTarget = {x: x, y: y},\n                  gravityXStart = x - targetXY.xGravity,\n                  gravityXEnd = x + targetXY.xGravity,\n                  gravityYStart = y - targetXY.yGravity,\n                  gravityYEnd = y + targetXY.yGravity;\n                if (gravityXStart > minXY.x) { snapTarget.gravityXStart = gravityXStart; }\n                if (gravityXEnd < maxXY.x) { snapTarget.gravityXEnd = gravityXEnd; }\n                if (gravityYStart > minXY.y) { snapTarget.gravityYStart = gravityYStart; }\n                if (gravityYEnd < maxXY.y) { snapTarget.gravityYEnd = gravityYEnd; }\n                snapTargets.push(snapTarget);\n              }\n            });\n\n          } else { // Line\n            const specAxis = targetXY.x != null ? 'x' : 'y', rangeAxis = specAxis === 'x' ? 'y' : 'x',\n              startProp = `${rangeAxis}Start`, endProp = `${rangeAxis}End`,\n              gravityProp = `${specAxis}Gravity`,\n              specAxisL = specAxis.toUpperCase(), rangeAxisL = rangeAxis.toUpperCase(),\n              gravitySpecStartProp = `gravity${specAxisL}Start`,\n              gravitySpecEndProp = `gravity${specAxisL}End`,\n              gravityRangeStartProp = `gravity${rangeAxisL}Start`,\n              gravityRangeEndProp = `gravity${rangeAxisL}End`;\n            targetXY[specAxis] =\n              resolvePPValue(targetXY[specAxis], baseOriginXY[specAxis], baseSizeXY[specAxis]);\n            targetXY[startProp] =\n              resolvePPValue(targetXY[startProp], baseOriginXY[rangeAxis], baseSizeXY[rangeAxis]);\n            targetXY[endProp] =\n              resolvePPValue(targetXY[endProp], baseOriginXY[rangeAxis], baseSizeXY[rangeAxis]) -\n              elementSizeXY[rangeAxis]; // Reduce the end of the line.\n            if (targetXY[startProp] > targetXY[endProp] || // Smaller than element size.\n                targetXY[startProp] > maxXY[rangeAxis] || targetXY[endProp] < minXY[rangeAxis]) {\n              return;\n            }\n\n            if (targetXY.center) {\n              targetXY[specAxis] -= elementSizeXY[specAxis] / 2;\n              targetXY.sides = ['start'];\n            }\n\n            (targetXY.sides || parsedSnapTarget.sides).forEach(side => {\n              const xy = targetXY[specAxis] - (side === 'end' ? elementSizeXY[specAxis] : 0);\n              if (xy >= minXY[specAxis] && xy <= maxXY[specAxis]) {\n                const snapTarget = {},\n                  gravitySpecStart = xy - targetXY[gravityProp],\n                  gravitySpecEnd = xy + targetXY[gravityProp];\n                snapTarget[specAxis] = xy;\n                if (gravitySpecStart > minXY[specAxis]) {\n                  snapTarget[gravitySpecStartProp] = gravitySpecStart;\n                }\n                if (gravitySpecEnd < maxXY[specAxis]) {\n                  snapTarget[gravitySpecEndProp] = gravitySpecEnd;\n                }\n                if (targetXY[startProp] > minXY[rangeAxis]) {\n                  snapTarget[gravityRangeStartProp] = targetXY[startProp];\n                }\n                if (targetXY[endProp] < maxXY[rangeAxis]) {\n                  snapTarget[gravityRangeEndProp] = targetXY[endProp];\n                }\n                snapTargets.push(snapTarget);\n              }\n            });\n          }\n        }\n\n        let bBox;\n        if ((bBox = parsedSnapTarget.element ? getBBox(parsedSnapTarget.element) : null) || // Element\n            parsedSnapTarget.ppBBox) {\n          if (parsedSnapTarget.ppBBox) { bBox = resolvePPBBox(parsedSnapTarget.ppBBox, baseRect); } // BBox\n          if (bBox) { // Drop invalid BBox.\n            // Expand into 4 lines.\n            parsedSnapTarget.edges.forEach(edge => {\n              let lengthenX = parsedSnapTarget.gravity, lengthenY = parsedSnapTarget.gravity;\n              if (edge === 'outside') { // Snap it when a part of the element is part of the range.\n                lengthenX += elementBBox.width;\n                lengthenY += elementBBox.height;\n              }\n              const xStart = bBox.left - lengthenX, xEnd = bBox.right + lengthenX,\n                yStart = bBox.top - lengthenY, yEnd = bBox.bottom + lengthenY;\n              let side = edge === 'inside' ? 'start' : 'end';\n              addSnapTarget({xStart: xStart, xEnd: xEnd, y: bBox.top, sides: [side], center: false}); // Top\n              addSnapTarget({x: bBox.left, yStart: yStart, yEnd: yEnd, sides: [side], center: false}); // Left\n              side = edge === 'inside' ? 'end' : 'start';\n              addSnapTarget({xStart: xStart, xEnd: xEnd, y: bBox.bottom, sides: [side], center: false}); // Bottom\n              addSnapTarget({x: bBox.right, yStart: yStart, yEnd: yEnd, sides: [side], center: false}); // Right\n            });\n          }\n\n        } else {\n          let expanded = [\n            ['x', 'y', 'xStart', 'xEnd', 'xStep', 'yStart', 'yEnd', 'yStep'].reduce((targetXY, prop) => {\n              if (parsedSnapTarget[prop]) {\n                targetXY[prop] = resolvePPValue(parsedSnapTarget[prop],\n                  prop === 'xStep' || prop === 'yStep' ? 0 : baseOriginXY[prop2Axis[prop]],\n                  baseSizeXY[prop2Axis[prop]]);\n              }\n              return targetXY;\n            }, {})\n          ];\n\n          ['x', 'y'].forEach(axis => {\n            const startProp = `${axis}Start`, endProp = `${axis}End`, stepProp = `${axis}Step`,\n              gravityProp = `${axis}Gravity`;\n            expanded = expanded.reduce((expanded, targetXY) => {\n              let start = targetXY[startProp], end = targetXY[endProp], step = targetXY[stepProp];\n              if (start != null && end != null && start >= end) { return expanded; } // start >= end\n\n              if (step != null) {\n                if (step < 2) { return expanded; }\n                // step >= 2px -> Expand by step\n                let gravity = step / 2; // max\n                gravity = parsedSnapTarget.gravity > gravity ? gravity : null;\n                for (let curValue = start; curValue <= end; curValue += step) {\n                  const expandedXY = Object.keys(targetXY).reduce((expandedXY, prop) => {\n                    if (prop !== startProp && prop !== endProp && prop !== stepProp) {\n                      expandedXY[prop] = targetXY[prop];\n                    }\n                    return expandedXY;\n                  }, {});\n                  expandedXY[axis] = curValue;\n                  expandedXY[gravityProp] = gravity;\n                  expanded.push(expandedXY);\n                }\n\n              } else {\n                expanded.push(targetXY);\n              }\n              return expanded;\n            }, []);\n          });\n          expanded.forEach(targetXY => { addSnapTarget(targetXY); });\n        }\n\n        return snapTargets;\n      }, []);\n\n    props.snapTargets = snapTargets.length ? snapTargets : null;\n  }\n  // [/SNAP]\n  window.initBBoxDone = true; // [DEBUG/]\n}\n\nfunction dragEnd(props) {\n  setDraggableCursor(props.options.handle, props.orgCursor);\n  body.style.cursor = cssOrgValueBodyCursor;\n\n  if (props.options.zIndex !== false) { props.elementStyle.zIndex = props.orgZIndex; }\n  if (cssPropUserSelect) { body.style[cssPropUserSelect] = cssOrgValueBodyUserSelect; }\n  const classList = mClassList(props.element);\n  if (movingClass) { classList.remove(movingClass); }\n  if (draggingClass) { classList.remove(draggingClass); }\n\n  activeItem = null;\n  if (props.onDragEnd) { props.onDragEnd(); }\n}\n\nfunction mousedown(props, event) {\n  if (props.disabled) { return; }\n  if (activeItem) { dragEnd(activeItem); } // activeItem is normally null by `mouseup`.\n\n  setDraggingCursor(props.options.handle);\n  body.style.cursor = cssValueDraggingCursor || // If it is `false` or `''`\n    window.getComputedStyle(props.options.handle, '').cursor;\n\n  if (props.options.zIndex !== false) { props.elementStyle.zIndex = props.options.zIndex; }\n  if (cssPropUserSelect) { body.style[cssPropUserSelect] = 'none'; }\n  if (draggingClass) { mClassList(props.element).add(draggingClass); }\n\n  activeItem = props;\n  hasMoved = false;\n  pointerOffset = {left: props.elementBBox.left - event.pageX, top: props.elementBBox.top - event.pageY};\n}\n\n/**\n * @param {props} props - `props` of instance.\n * @param {Object} newOptions - New options.\n * @returns {void}\n */\nfunction setOptions(props, newOptions) {\n  const options = props.options;\n  let needsInitBBox;\n\n  // containment\n  if (newOptions.containment) {\n    let bBox;\n    if (isElement(newOptions.containment)) { // Specific element\n      if (newOptions.containment !== options.containment) {\n        // Restore\n        props.scrollElements.forEach(element => {\n          element.removeEventListener('scroll', props.handleScroll, false);\n        });\n        props.scrollElements = [];\n        window.removeEventListener('scroll', props.handleScroll, false);\n        // Parse tree\n        let element = newOptions.containment, fixedElement;\n        while (element && element !== body) {\n          if (element.nodeType === Node.ELEMENT_NODE) {\n            const cmpStyle = window.getComputedStyle(element, '');\n            // Scrollable element\n            if (!(element instanceof SVGElement) && (\n                cmpStyle.overflow !== 'visible' || cmpStyle.overflowX !== 'visible' ||\n                cmpStyle.overflowY !== 'visible' // `hidden` also is scrollable.\n                )) {\n              element.addEventListener('scroll', props.handleScroll, false);\n              props.scrollElements.push(element);\n            }\n            // Element that is re-positioned (document based) when window scrolled.\n            if (cmpStyle.position === 'fixed') { fixedElement = true; }\n          }\n          element = element.parentNode;\n        }\n        if (fixedElement) {\n          window.addEventListener('scroll', props.handleScroll, false);\n        }\n\n        options.containment = newOptions.containment;\n        props.containmentIsBBox = false;\n        needsInitBBox = true;\n      }\n    } else if ((bBox = validPPBBox(copyTree(newOptions.containment))) && // bBox\n        hasChanged(bBox, options.containment)) {\n      options.containment = bBox;\n      props.containmentIsBBox = true;\n      needsInitBBox = true;\n    }\n  }\n\n  // [SNAP]\n\n  /**\n   * @typedef {Object} SnapOptions\n   * @property {SnapTargetOptions[]} targets\n   * @property {number} [gravity]\n   * @property {string} [corner]\n   * @property {string} [side]\n   * @property {boolean} [center]\n   * @property {string} [edge]\n   * @property {string} [base]\n   */\n\n  /**\n   * @typedef {Object} SnapTargetOptions\n   * @property {(number|string)} [x] - pixels | '<n>%' | {start, end} | {step, start, end}\n   * @property {(number|string)} [y]\n   * @property {(Element|Object)} [boundingBox] - Object has properties that are string or number from PPBBox.\n   * @property {number} [gravity]\n   * @property {string} [corner]\n   * @property {string} [side]\n   * @property {boolean} [center]\n   * @property {string} [edge]\n   * @property {string} [base]\n   */\n\n  /**\n   * @typedef {Object} ParsedSnapTarget\n   * @property {PPValue} [x] - (input: pixels | '<n>%')\n   * @property {PPValue} [y]\n   * @property {PPValue} [xStart] - (input: {start, end} | {step, start, end})\n   * @property {PPValue} [xEnd]\n   * @property {PPValue} [xStep] - (input: {step, start, end})\n   * @property {PPValue} [yStart]\n   * @property {PPValue} [yEnd]\n   * @property {PPValue} [yStep]\n   * @property {Element} [element]\n   * @property {PPBBox} [ppBBox]\n   * @property {number} gravity\n   * @property {string[]} corners\n   * @property {string[]} sides\n   * @property {boolean} center\n   * @property {string[]} edges\n   * @property {string} base\n   */\n\n  // Normalize `gravity`, `corner`, `side`, `center`, `edge`, `base`\n  function commonSnapOptions(options, newOptions) {\n    function cleanString(inString) {\n      return typeof inString === 'string' ?\n        inString.replace(/[, ]+/g, ' ').trim().toLowerCase() : null;\n    }\n\n    // gravity\n    if (isFinite(newOptions.gravity) && newOptions.gravity > 0) { options.gravity = newOptions.gravity; }\n    // corner\n    let corner = cleanString(newOptions.corner);\n    if (corner) {\n      if (corner !== 'all') {\n        const added = {},\n          corners = corner.split(/\\s/).reduce((corners, corner) => {\n            corner = corner.trim().replace(/^(.).*?\\-(.).*$/, '$1$2');\n            if ((corner =\n                corner === 'tl' || corner === 'lt' ? 'tl' :\n                corner === 'tr' || corner === 'rt' ? 'tr' :\n                corner === 'bl' || corner === 'lb' ? 'bl' :\n                corner === 'br' || corner === 'rb' ? 'br' :\n                null) && !added[corner]) {\n              corners.push(corner);\n              added[corner] = true;\n            }\n            return corners;\n          }, []),\n          cornersLen = corners.length;\n        corner = !cornersLen ? null : cornersLen === 4 ? 'all' : corners.join(' ');\n      }\n      if (corner) { options.corner = corner; }\n    }\n    // side\n    const side = cleanString(newOptions.side);\n    if (side) {\n      if (side === 'start' || side === 'end' || side === 'both') {\n        options.side = side;\n      } else if (side === 'start end' || side === 'end start') {\n        options.side = 'both';\n      }\n    }\n    // center\n    if (typeof newOptions.center === 'boolean') { options.center = newOptions.center; }\n    // edge\n    const edge = cleanString(newOptions.edge);\n    if (edge) {\n      if (edge === 'inside' || edge === 'outside' || edge === 'both') {\n        options.edge = edge;\n      } else if (edge === 'inside outside' || edge === 'outside inside') {\n        options.edge = 'both';\n      }\n    }\n    // base\n    const base = typeof newOptions.base === 'string' ? newOptions.base.trim().toLowerCase() : null;\n    if (base && (base === 'containment' || base === 'document')) { options.base = base; }\n    return options;\n  }\n  window.commonSnapOptions = commonSnapOptions; // [DEBUG/]\n\n  // snap\n  if (newOptions.snap != null) {\n    const newSnapOptions =\n        isObject(newOptions.snap) && (newOptions.snap.targets != null) ? newOptions.snap :\n        {targets: newOptions.snap},\n      snapTargetsOptions = [],\n      snapOptions = commonSnapOptions({targets: snapTargetsOptions}, newSnapOptions);\n\n    // Set default options into top level.\n    if (!snapOptions.gravity) { snapOptions.gravity = SNAP_GRAVITY; }\n    if (!snapOptions.corner) { snapOptions.corner = SNAP_CORNER; }\n    if (!snapOptions.side) { snapOptions.side = SNAP_SIDE; }\n    if (typeof snapOptions.center !== 'boolean') { snapOptions.center = false; }\n    if (!snapOptions.edge) { snapOptions.edge = SNAP_EDGE; }\n    if (!snapOptions.base) { snapOptions.base = SNAP_BASE; }\n\n    const parsedSnapTargets = (\n        Array.isArray(newSnapOptions.targets) ? newSnapOptions.targets : [newSnapOptions.targets]\n      ).reduce((parsedSnapTargets, target) => {\n        if (target == null) { return parsedSnapTargets; }\n\n        const isElementPre = isElement(target), // Pre-check direct value\n          ppBBoxPre = validPPBBox(copyTree(target)), // Pre-check direct value\n          newSnapTargetOptions =\n            isElementPre || ppBBoxPre ? {boundingBox: target} : // Direct Element | PPBBox\n            isObject(target) &&\n              target.start == null && target.end == null && target.step == null ? target : // SnapTargetOptions\n            {x: target, y: target}, // Others, it might be {step, start, end}\n          expandedParsedSnapTargets = [],\n          snapTargetOptions = {},\n          newOptionsBBox = newSnapTargetOptions.boundingBox;\n        let ppBBox;\n\n        if (isElementPre || isElement(newOptionsBBox)) { // Element\n          expandedParsedSnapTargets.push({element: newOptionsBBox});\n          snapTargetOptions.boundingBox = newOptionsBBox;\n        } else if ((ppBBox = ppBBoxPre || validPPBBox(copyTree(newOptionsBBox)))) { // Object -> PPBBox\n          expandedParsedSnapTargets.push({ppBBox: ppBBox});\n          snapTargetOptions.boundingBox = ppBBox2OptionObject(ppBBox);\n\n        } else {\n          let invalid; // `true` if valid PPValue was given but the contained value is invalid.\n          const parsedXY = ['x', 'y'].reduce((parsedXY, axis) => {\n            const newOptionsXY = newSnapTargetOptions[axis];\n            let ppValue;\n\n            if ((ppValue = validPPValue(newOptionsXY))) { // pixels | '<n>%'\n              parsedXY[axis] = ppValue;\n              snapTargetOptions[axis] = ppValue2OptionValue(ppValue);\n\n            } else { // {start, end} | {step, start, end}\n              let start, end, step;\n              if (isObject(newOptionsXY)) {\n                start = validPPValue(newOptionsXY.start);\n                end = validPPValue(newOptionsXY.end);\n                step = validPPValue(newOptionsXY.step);\n                if (start && end && start.isRatio === end.isRatio && start.value >= end.value) { // start >= end\n                  invalid = true;\n                }\n              }\n              start = parsedXY[`${axis}Start`] = start || {value: 0, isRatio: false};\n              end = parsedXY[`${axis}End`] = end || {value: 1, isRatio: true};\n              snapTargetOptions[axis] = {start: ppValue2OptionValue(start), end: ppValue2OptionValue(end)};\n              if (step) {\n                if (step.isRatio ? step.value > 0 : step.value >= 2) { // step > 0% || step >= 2px\n                  parsedXY[`${axis}Step`] = step;\n                  snapTargetOptions[axis].step = ppValue2OptionValue(step);\n                } else {\n                  invalid = true;\n                }\n              }\n            }\n            return parsedXY;\n          }, {});\n          if (invalid) { return parsedSnapTargets; }\n\n          if (parsedXY.xStart && !parsedXY.xStep && parsedXY.yStart && !parsedXY.yStep) {\n            // Expand into 4 lines. This is not BBox, and `edge` is ignored.\n            expandedParsedSnapTargets.push(\n              {xStart: parsedXY.xStart, xEnd: parsedXY.xEnd, y: parsedXY.yStart}, // Top\n              {xStart: parsedXY.xStart, xEnd: parsedXY.xEnd, y: parsedXY.yEnd}, // Bottom\n              {x: parsedXY.xStart, yStart: parsedXY.yStart, yEnd: parsedXY.yEnd}, // Left\n              {x: parsedXY.xEnd, yStart: parsedXY.yStart, yEnd: parsedXY.yEnd} // Right\n            );\n          } else {\n            expandedParsedSnapTargets.push(parsedXY);\n          }\n        }\n\n        if (expandedParsedSnapTargets.length) {\n          snapTargetsOptions.push(commonSnapOptions(snapTargetOptions, newSnapTargetOptions));\n          // Copy common SnapOptions\n          const corner = snapTargetOptions.corner || snapOptions.corner,\n            side = snapTargetOptions.side || snapOptions.side,\n            edge = snapTargetOptions.edge || snapOptions.edge,\n            commonOptions = {\n              gravity: snapTargetOptions.gravity || snapOptions.gravity,\n              base: snapTargetOptions.base || snapOptions.base,\n              center: typeof snapTargetOptions.center === 'boolean' ?\n                snapTargetOptions.center : snapOptions.center,\n              corners: corner === 'all' ? SNAP_ALL_CORNERS : corner.split(' '), // Split\n              sides: side === 'both' ? SNAP_ALL_SIDES : [side], // Split\n              edges: edge === 'both' ? SNAP_ALL_EDGES : [edge] // Split\n            };\n          expandedParsedSnapTargets.forEach(parsedSnapTarget => {\n            // Set common SnapOptions\n            ['gravity', 'corners', 'sides', 'center', 'edges', 'base'].forEach(\n              option => { parsedSnapTarget[option] = commonOptions[option]; });\n            parsedSnapTargets.push(parsedSnapTarget);\n          });\n        }\n        return parsedSnapTargets;\n      }, []);\n\n    if (parsedSnapTargets.length) {\n      options.snap = snapOptions; // Update always\n      if (hasChanged(parsedSnapTargets, props.parsedSnapTargets)) {\n        props.parsedSnapTargets = parsedSnapTargets;\n        needsInitBBox = true;\n      }\n    }\n  } else if (newOptions.hasOwnProperty('snap') && props.parsedSnapTargets) {\n    options.snap = props.parsedSnapTargets = props.snapTargets = void 0;\n  }\n\n  // [/SNAP]\n\n  if (needsInitBBox) { initBBox(props); }\n\n  // Gecko, Trident pick drag-event of some elements such as img, a, etc.\n  function dragstart(event) { event.preventDefault(); }\n\n  // handle\n  if (isElement(newOptions.handle) && newOptions.handle !== options.handle) {\n    if (options.handle) { // Restore\n      options.handle.style.cursor = props.orgCursor;\n      if (cssPropUserSelect) { options.handle.style[cssPropUserSelect] = props.orgUserSelect; }\n      options.handle.removeEventListener('dragstart', dragstart, false);\n      options.handle.removeEventListener('mousedown', props.handleMousedown, false);\n    }\n    const handle = options.handle = newOptions.handle;\n    props.orgCursor = handle.style.cursor;\n    setDraggableCursor(handle, props.orgCursor);\n    if (cssPropUserSelect) {\n      props.orgUserSelect = handle.style[cssPropUserSelect];\n      handle.style[cssPropUserSelect] = 'none';\n    }\n    handle.addEventListener('dragstart', dragstart, false);\n    handle.addEventListener('mousedown', props.handleMousedown, false);\n  }\n\n  // zIndex\n  if (isFinite(newOptions.zIndex) || newOptions.zIndex === false) {\n    options.zIndex = newOptions.zIndex;\n    if (props === activeItem) {\n      props.elementStyle.zIndex = options.zIndex === false ? props.orgZIndex : options.zIndex;\n    }\n  }\n\n  // left/top\n  const position = {left: props.elementBBox.left, top: props.elementBBox.top};\n  let needsMove;\n  if (isFinite(newOptions.left) && newOptions.left !== position.left) {\n    position.left = newOptions.left;\n    needsMove = true;\n  }\n  if (isFinite(newOptions.top) && newOptions.top !== position.top) {\n    position.top = newOptions.top;\n    needsMove = true;\n  }\n  if (needsMove) { move(props, position); }\n\n  // Event listeners\n  ['onDrag', 'onMove', 'onMoveStart', 'onDragEnd'].forEach(option => {\n    if (typeof newOptions[option] === 'function') {\n      options[option] = newOptions[option];\n      props[option] = options[option].bind(props.ins);\n    } else if (newOptions.hasOwnProperty(option) && newOptions[option] == null) {\n      options[option] = props[option] = void 0;\n    }\n  });\n}\n\nclass PlainDraggable {\n  /**\n   * Create a `PlainDraggable` instance.\n   * @param {Element} element - Target element.\n   * @param {Object} [options] - Options.\n   */\n  constructor(element, options) {\n    const props = {\n      ins: this,\n      options: { // Initial options (not default)\n        zIndex: ZINDEX // Initial state.\n      },\n      disabled: false\n    };\n\n    Object.defineProperty(this, '_id', {value: ++insId});\n    props._id = this._id;\n    insProps[this._id] = props;\n    props.initArguments = Array.prototype.slice.call(arguments); // [DEBUG/]\n\n    if (!isElement(element) || element === body) { throw new Error('This element is not accepted.'); }\n    if (!options) {\n      options = {};\n    } else if (!isObject(options)) {\n      throw new Error('Invalid options.');\n    }\n\n    let gpuTrigger = true;\n    // [SVG]\n    let ownerSvg;\n    // SVGElement which is not root view\n    if (element instanceof SVGElement && (ownerSvg = element.ownerSVGElement)) {\n      // It means `instanceof SVGLocatable` (many browsers don't have SVGLocatable)\n      if (!element.getBBox) { throw new Error('This element is not accepted. (SVGLocatable)'); }\n      // Trident and Edge bug, SVGSVGElement doesn't have SVGAnimatedTransformList?\n      if (!element.transform) {\n        throw new Error('This element is not accepted. (SVGAnimatedTransformList)');\n      }\n      // Trident bug, returned value must be used (That is not given value).\n      props.svgTransform = element.transform.baseVal.appendItem(ownerSvg.createSVGTransform());\n      props.svgPoint = ownerSvg.createSVGPoint();\n      // Gecko bug, view.getScreenCTM returns CTM with root view.\n      const svgView = element.nearestViewportElement;\n      props.svgCtmElement = !IS_GECKO ? svgView :\n        svgView.appendChild(document.createElementNS(ownerSvg.namespaceURI, 'rect'));\n      gpuTrigger = false;\n      props.initElm = initSvg;\n      props.moveElm = moveSvg;\n\n    } else {\n      // [/SVG]\n      const cssPropWillChange = CSSPrefix.getName('willChange');\n      if (cssPropWillChange) { gpuTrigger = false; }\n\n      if (!options.leftTop && cssPropTransform) { // translate\n        if (cssPropWillChange) { element.style[cssPropWillChange] = 'transform'; }\n        props.initElm = initTranslate;\n        props.moveElm = moveTranslate;\n\n      } else { // left and top\n        // [LEFTTOP]\n        if (cssPropWillChange) { element.style[cssPropWillChange] = 'left, top'; }\n        props.initElm = initLeftTop;\n        props.moveElm = moveLeftTop;\n        // [/LEFTTOP]\n        /* [LEFTTOP/]\n        throw new Error('`transform` is not supported.');\n        [LEFTTOP/] */\n      }\n    } // [SVG/]\n\n    props.element = initAnim(element, gpuTrigger);\n    props.elementStyle = element.style;\n    props.orgZIndex = props.elementStyle.zIndex;\n    if (draggableClass) { mClassList(element).add(draggableClass); }\n    // Prepare removable event listeners for each instance.\n    props.handleMousedown = event => { mousedown(props, event); };\n    props.handleScroll = AnimEvent.add(() => { initBBox(props); });\n    props.scrollElements = [];\n\n    // Default options\n    if (!options.containment) {\n      let parent;\n      options.containment = (parent = element.parentNode) && isElement(parent) ? parent : body;\n    }\n    if (!options.handle) { options.handle = element; }\n\n    setOptions(props, options);\n  }\n\n  /**\n   * @param {Object} options - New options.\n   * @returns {PlainDraggable} Current instance itself.\n   */\n  setOptions(options) {\n    if (isObject(options)) {\n      setOptions(insProps[this._id], options);\n    }\n    return this;\n  }\n\n  position() {\n    initBBox(insProps[this._id]);\n    return this;\n  }\n\n  get disabled() {\n    return insProps[this._id].disabled;\n  }\n  set disabled(value) {\n    const props = insProps[this._id];\n    if ((value = !!value) !== props.disabled) {\n      props.disabled = value;\n      if (props.disabled) {\n        if (props === activeItem) { dragEnd(props); }\n        props.options.handle.style.cursor = props.orgCursor;\n        if (cssPropUserSelect) { props.options.handle.style[cssPropUserSelect] = props.orgUserSelect; }\n        if (draggableClass) { mClassList(props.element).remove(draggableClass); }\n      } else {\n        setDraggableCursor(props.options.handle, props.orgCursor);\n        if (cssPropUserSelect) { props.options.handle.style[cssPropUserSelect] = 'none'; }\n        if (draggableClass) { mClassList(props.element).add(draggableClass); }\n      }\n    }\n  }\n\n  get element() {\n    return insProps[this._id].element;\n  }\n\n  get rect() {\n    return copyTree(insProps[this._id].elementBBox);\n  }\n\n  get left() { return insProps[this._id].elementBBox.left; }\n  set left(value) { setOptions(insProps[this._id], {left: value}); }\n\n  get top() { return insProps[this._id].elementBBox.top; }\n  set top(value) { setOptions(insProps[this._id], {top: value}); }\n\n  get containment() {\n    const props = insProps[this._id];\n    return props.containmentIsBBox ?\n      ppBBox2OptionObject(props.options.containment) : props.options.containment;\n  }\n  set containment(value) { setOptions(insProps[this._id], {containment: value}); }\n\n  // [SNAP]\n  get snap() { return copyTree(insProps[this._id].options.snap); }\n  set snap(value) { setOptions(insProps[this._id], {snap: value}); }\n  // [/SNAP]\n\n  get handle() { return insProps[this._id].options.handle; }\n  set handle(value) { setOptions(insProps[this._id], {handle: value}); }\n\n  get zIndex() { return insProps[this._id].options.zIndex; }\n  set zIndex(value) { setOptions(insProps[this._id], {zIndex: value}); }\n\n  get onDrag() { return insProps[this._id].options.onDrag; }\n  set onDrag(value) { setOptions(insProps[this._id], {onDrag: value}); }\n\n  get onMove() { return insProps[this._id].options.onMove; }\n  set onMove(value) { setOptions(insProps[this._id], {onMove: value}); }\n\n  get onMoveStart() { return insProps[this._id].options.onMoveStart; }\n  set onMoveStart(value) { setOptions(insProps[this._id], {onMoveStart: value}); }\n\n  get onDragEnd() { return insProps[this._id].options.onDragEnd; }\n  set onDragEnd(value) { setOptions(insProps[this._id], {onDragEnd: value}); }\n\n  static get draggableCursor() {\n    return cssWantedValueDraggableCursor;\n  }\n  static set draggableCursor(value) {\n    if (cssWantedValueDraggableCursor !== value) {\n      cssWantedValueDraggableCursor = value;\n      cssValueDraggableCursor = null; // Reset\n      Object.keys(insProps).forEach(id => {\n        const props = insProps[id];\n        if (props.disabled || props === activeItem && cssValueDraggingCursor !== false) { return; }\n        setDraggableCursor(props.options.handle, props.orgCursor);\n        if (props === activeItem) { // Since cssValueDraggingCursor is `false`, copy cursor again.\n          body.style.cursor = cssOrgValueBodyCursor;\n          body.style.cursor = window.getComputedStyle(props.options.handle, '').cursor;\n        }\n      });\n    }\n  }\n\n  static get draggingCursor() {\n    return cssWantedValueDraggingCursor;\n  }\n  static set draggingCursor(value) {\n    if (cssWantedValueDraggingCursor !== value) {\n      cssWantedValueDraggingCursor = value;\n      cssValueDraggingCursor = null; // Reset\n      if (activeItem) {\n        setDraggingCursor(activeItem.options.handle);\n        if (cssValueDraggingCursor === false) {\n          setDraggableCursor(activeItem.options.handle, activeItem.orgCursor); // draggableCursor\n          body.style.cursor = cssOrgValueBodyCursor;\n        }\n        body.style.cursor = cssValueDraggingCursor || // If it is `false` or `''`\n          window.getComputedStyle(activeItem.options.handle, '').cursor;\n      }\n    }\n  }\n\n  static get draggableClass() {\n    return draggableClass;\n  }\n  static set draggableClass(value) {\n    value = value ? (value + '') : void 0;\n    if (value !== draggableClass) {\n      Object.keys(insProps).forEach(id => {\n        const props = insProps[id];\n        if (!props.disabled) {\n          const classList = mClassList(props.element);\n          if (draggableClass) { classList.remove(draggableClass); }\n          if (value) { classList.add(value); }\n        }\n      });\n      draggableClass = value;\n    }\n  }\n\n  static get draggingClass() {\n    return draggingClass;\n  }\n  static set draggingClass(value) {\n    value = value ? (value + '') : void 0;\n    if (value !== draggingClass) {\n      if (activeItem) {\n        const classList = mClassList(activeItem.element);\n        if (draggingClass) { classList.remove(draggingClass); }\n        if (value) { classList.add(value); }\n      }\n      draggingClass = value;\n    }\n  }\n\n  static get movingClass() {\n    return movingClass;\n  }\n  static set movingClass(value) {\n    value = value ? (value + '') : void 0;\n    if (value !== movingClass) {\n      if (activeItem && hasMoved) {\n        const classList = mClassList(activeItem.element);\n        if (movingClass) { classList.remove(movingClass); }\n        if (value) { classList.add(value); }\n      }\n      movingClass = value;\n    }\n  }\n}\n\ndocument.addEventListener('mousemove', AnimEvent.add(event => {\n  if (activeItem &&\n      move(activeItem, {\n        left: event.pageX + pointerOffset.left,\n        top: event.pageY + pointerOffset.top\n      },\n      // [SNAP]\n      activeItem.snapTargets ? position => { // Snap\n        let snappedX = false, snappedY = false, i, iLen = activeItem.snapTargets.length;\n        for (i = 0; i < iLen && (!snappedX || !snappedY); i++) {\n          const snapTarget = activeItem.snapTargets[i];\n          if ((snapTarget.gravityXStart == null || position.left >= snapTarget.gravityXStart) &&\n              (snapTarget.gravityXEnd == null || position.left <= snapTarget.gravityXEnd) &&\n              (snapTarget.gravityYStart == null || position.top >= snapTarget.gravityYStart) &&\n              (snapTarget.gravityYEnd == null || position.top <= snapTarget.gravityYEnd)) {\n            if (!snappedX && snapTarget.x != null) {\n              position.left = snapTarget.x;\n              snappedX = true;\n              i = -1; // Restart loop\n            }\n            if (!snappedY && snapTarget.y != null) {\n              position.top = snapTarget.y;\n              snappedY = true;\n              i = -1; // Restart loop\n            }\n          }\n        }\n        position.snapped = snappedX || snappedY;\n        return activeItem.onDrag ? activeItem.onDrag(position) : true;\n      } :\n      // [/SNAP]\n      activeItem.onDrag)) {\n\n    if (!hasMoved) {\n      hasMoved = true;\n      if (movingClass) { mClassList(activeItem.element).add(movingClass); }\n      if (activeItem.onMoveStart) { activeItem.onMoveStart(); }\n    }\n    if (activeItem.onMove) { activeItem.onMove(); }\n  }\n}), false);\n\ndocument.addEventListener('mouseup', () => { // It might occur outside body.\n  if (activeItem) { dragEnd(activeItem); }\n}, false);\n\n{\n  let resizing = false;\n  function initDoc() {\n    cssPropTransform = CSSPrefix.getName('transform');\n    cssOrgValueBodyCursor = body.style.cursor;\n    if ((cssPropUserSelect = CSSPrefix.getName('userSelect'))) {\n      cssOrgValueBodyUserSelect = body.style[cssPropUserSelect];\n    }\n\n    // Gecko bug, multiple calling (parallel) by `requestAnimationFrame`.\n    window.addEventListener('resize', AnimEvent.add(() => {\n      if (resizing) {\n        console.log('`resize` event listener is already running.'); // [DEBUG/]\n        return;\n      }\n      resizing = true;\n      Object.keys(insProps).forEach(id => {\n        if (insProps[id].initElm) { // Easy checking for instance without errors.\n          initBBox(insProps[id]);\n        }\n        // eslint-disable-next-line brace-style\n        else { console.log('instance may have an error:'); console.log(insProps[id]); } // [DEBUG/]\n      });\n      resizing = false;\n    }), true);\n  }\n\n  if ((body = document.body)) {\n    initDoc();\n  } else {\n    document.addEventListener('DOMContentLoaded', () => {\n      body = document.body;\n      initDoc();\n    }, false);\n  }\n}\n\n/* [SNAP/]\nPlainDraggable.limit = true;\n[SNAP/] */\n\nexport default PlainDraggable;\n\n\n\n// WEBPACK FOOTER //\n// ./src/plain-draggable.js","/*\n * CSSPrefix\n * https://github.com/anseki/cssprefix\n *\n * Copyright (c) 2018 anseki\n * Licensed under the MIT license.\n */\n\nfunction ucf(text) { return text.substr(0, 1).toUpperCase() + text.substr(1); }\n\nconst PREFIXES = ['webkit', 'ms', 'moz', 'o'],\n  NAME_PREFIXES = PREFIXES.reduce((prefixes, prefix) => {\n    prefixes.push(prefix);\n    prefixes.push(ucf(prefix));\n    return prefixes;\n  }, []),\n  VALUE_PREFIXES = PREFIXES.map(prefix => `-${prefix}-`),\n\n  /**\n   * Get sample CSSStyleDeclaration.\n   * @returns {CSSStyleDeclaration}\n   */\n  getDeclaration = (() => {\n    let declaration;\n    return () => (declaration = declaration || document.createElement('div').style);\n  })(),\n\n  /**\n   * Normalize name.\n   * @param {} propName - A name that is normalized.\n   * @returns {string} A normalized name.\n   */\n  normalizeName = (() => {\n    const rePrefixedName = new RegExp('^(?:' + PREFIXES.join('|') + ')(.)', 'i'),\n      reUc = /[A-Z]/;\n    return propName => (propName = (propName + '').replace(/\\s/g, '')\n      .replace(/-([\\da-z])/gi, (str, p1) => p1.toUpperCase()) // camelCase\n      // 'ms' and 'Ms' are found by rePrefixedName 'i' option\n      .replace(rePrefixedName, (str, p1) => reUc.test(p1) ? p1.toLowerCase() : str) // Remove prefix\n    ).toLowerCase() === 'float' ? 'cssFloat' : propName; // For old CSSOM\n  })(),\n\n  /**\n   * Normalize value.\n   * @param {} propValue - A value that is normalized.\n   * @returns {string} A normalized value.\n   */\n  normalizeValue = (() => {\n    const rePrefixedValue = new RegExp('^(?:' + VALUE_PREFIXES.join('|') + ')', 'i');\n    return propValue => (propValue + '').replace(/\\s/g, '').replace(rePrefixedValue, '');\n  })(),\n\n  /**\n   * Polyfill for `CSS.supports`.\n   * @param {string} propName - A name.\n   * @param {string} propValue - A value.\n   * @returns {boolean} `true` if given pair is accepted.\n   */\n  cssSupports = (() => {\n    // return window.CSS && window.CSS.supports || ((propName, propValue) => {\n    // `CSS.supports` doesn't find prefixed property.\n    return ((propName, propValue) => {\n      const declaration = getDeclaration();\n      // In some browsers, `declaration[prop] = value` updates any property.\n      propName = propName.replace(/[A-Z]/g, str => `-${str.toLowerCase()}`); // kebab-case\n      declaration.setProperty(propName, propValue);\n      return declaration.getPropertyValue(propName) === propValue;\n    });\n  })(),\n\n  propNames = {}, propValues = {}; // Cache\n\n// [DEBUG]\nwindow.normalizeName = normalizeName;\nwindow.normalizeValue = normalizeValue;\nwindow.cssSupports = cssSupports;\n// [/DEBUG]\n\nfunction getName(propName) {\n  propName = normalizeName(propName);\n  if (propName && propNames[propName] == null) {\n    window.getNameDone = 'get'; // [DEBUG/]\n    const declaration = getDeclaration();\n\n    if (declaration[propName] != null) { // Original\n      propNames[propName] = propName;\n\n    } else { // Try with prefixes\n      const ucfName = ucf(propName);\n      if (!NAME_PREFIXES.some(prefix => {\n        const prefixed = prefix + ucfName;\n        if (declaration[prefixed] != null) {\n          propNames[propName] = prefixed;\n          return true;\n        }\n        return false;\n      })) {\n        propNames[propName] = false;\n      }\n    }\n\n  }\n  return propNames[propName] || void 0;\n}\n\nfunction getValue(propName, propValue) {\n  let res;\n\n  if (!(propName = getName(propName))) { return res; } // Invalid property\n\n  propValues[propName] = propValues[propName] || {};\n  (Array.isArray(propValue) ? propValue : [propValue]).some(propValue => {\n    propValue = normalizeValue(propValue);\n    (window.getValueDone = window.getValueDone || []).push(propValue); // [DEBUG/]\n\n    if (propValues[propName][propValue] != null) { // Cache\n      if (propValues[propName][propValue] !== false) {\n        res = propValues[propName][propValue];\n        return true;\n      } else {\n        return false; // Continue to next value\n      }\n    }\n    window.getValueDone.push('get'); // [DEBUG/]\n\n    if (cssSupports(propName, propValue)) { // Original\n      res = propValues[propName][propValue] = propValue;\n      return true;\n    }\n\n    if (VALUE_PREFIXES.some(prefix => { // Try with prefixes\n      const prefixed = prefix + propValue;\n      if (cssSupports(propName, prefixed)) {\n        res = propValues[propName][propValue] = prefixed;\n        return true;\n      }\n      return false;\n    })) {\n      return true;\n    }\n\n    propValues[propName][propValue] = false;\n    return false; // Continue to next value\n  });\n\n  return typeof res === 'string' ? res : void 0; // It might be empty string.\n}\n\nconst CSSPrefix = {\n  getName: getName,\n  getValue: getValue\n};\n\nexport default CSSPrefix;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/cssprefix/src/cssprefix.js","/*\n * AnimEvent\n * https://github.com/anseki/anim-event\n *\n * Copyright (c) 2018 anseki\n * Licensed under the MIT license.\n */\n\nconst\n  MSPF = 1000 / 60, // ms/frame (FPS: 60)\n  KEEP_LOOP = 500,\n\n  /**\n   * @typedef {Object} task\n   * @property {Event} event\n   * @property {function} listener\n   */\n\n  /** @type {task[]} */\n  tasks = [];\n\nlet\n  requestAnim = window.requestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    (callback => setTimeout(callback, MSPF)),\n  cancelAnim = window.cancelAnimationFrame ||\n    window.mozCancelAnimationFrame ||\n    window.webkitCancelAnimationFrame ||\n    window.msCancelAnimationFrame ||\n    (requestID => clearTimeout(requestID)),\n\n  requestID, lastFrameTime = Date.now();\n\n// [DEBUG]\nconst requestAnimSave = requestAnim, cancelAnimSave = cancelAnim;\nwindow.AnimEventByTimer = byTimer => {\n  if (byTimer) {\n    requestAnim = callback => setTimeout(callback, MSPF);\n    cancelAnim = requestID => clearTimeout(requestID);\n  } else {\n    requestAnim = requestAnimSave;\n    cancelAnim = cancelAnimSave;\n  }\n};\n// [/DEBUG]\n\nfunction step() {\n  let called, next;\n\n  if (requestID) {\n    cancelAnim.call(window, requestID);\n    requestID = null;\n  }\n\n  tasks.forEach(task => {\n    if (task.event) {\n      task.listener(task.event);\n      task.event = null;\n      called = true;\n    }\n  });\n\n  if (called) {\n    lastFrameTime = Date.now();\n    next = true;\n  } else if (Date.now() - lastFrameTime < KEEP_LOOP) { // Go on for a while\n    next = true;\n  }\n  if (next) { requestID = requestAnim.call(window, step); }\n}\n\nfunction indexOfTasks(listener) {\n  let index = -1;\n  tasks.some((task, i) => {\n    if (task.listener === listener) {\n      index = i;\n      return true;\n    }\n    return false;\n  });\n  return index;\n}\n\nconst AnimEvent = {\n  /**\n   * @param {function} listener - An event listener.\n   * @returns {(function|null)} A wrapped event listener.\n   */\n  add: function(listener) {\n    let task;\n    if (indexOfTasks(listener) === -1) {\n      tasks.push((task = {listener: listener}));\n      return event => {\n        task.event = event;\n        if (!requestID) { step(); }\n      };\n    } else {\n      return null;\n    }\n  },\n\n  remove: function(listener) {\n    let iRemove;\n    if ((iRemove = indexOfTasks(listener)) > -1) {\n      tasks.splice(iRemove, 1);\n      if (!tasks.length && requestID) {\n        cancelAnim.call(window, requestID);\n        requestID = null;\n      }\n    }\n  }\n};\n\nexport default AnimEvent;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/anim-event/src/anim-event.js","/*\n * mClassList\n * https://github.com/anseki/m-class-list\n *\n * Copyright (c) 2018 anseki\n * Licensed under the MIT license.\n */\n\nfunction normalize(token) { return (token + '').trim(); } // Not `||`\nfunction applyList(list, element) { element.setAttribute('class', list.join(' ')); }\n\nfunction add(list, element, tokens) {\n  if (tokens.filter(token => {\n    if (!(token = normalize(token)) || list.indexOf(token) !== -1) { return false; }\n    list.push(token);\n    return true;\n  }).length) {\n    applyList(list, element);\n  }\n}\n\nfunction remove(list, element, tokens) {\n  if (tokens.filter(token => {\n    let i;\n    if (!(token = normalize(token)) || (i = list.indexOf(token)) === -1) { return false; }\n    list.splice(i, 1);\n    return true;\n  }).length) {\n    applyList(list, element);\n  }\n}\n\nfunction toggle(list, element, token, force) {\n  const i = list.indexOf((token = normalize(token)));\n  if (i !== -1) {\n    if (force) { return true; }\n    list.splice(i, 1);\n    applyList(list, element);\n    return false;\n  } else {\n    if (force === false) { return false; }\n    list.push(token);\n    applyList(list, element);\n    return true;\n  }\n}\n\nfunction replace(list, element, token, newToken) {\n  let i;\n  if (!(token = normalize(token)) || !(newToken = normalize(newToken)) ||\n    token === newToken || (i = list.indexOf(token)) === -1) { return; }\n  list.splice(i, 1);\n  if (list.indexOf(newToken) === -1) { list.push(newToken); }\n  applyList(list, element);\n}\n\nfunction mClassList(element) {\n  return !mClassList.ignoreNative && element.classList || (() => {\n    const list = (element.getAttribute('class') || '').trim().split(/\\s+/).filter(token => !!token),\n      ins = {\n        length: list.length,\n        item: i => list[i],\n        contains: token => list.indexOf(normalize(token)) !== -1,\n        add: function() {\n          add(list, element, Array.prototype.slice.call(arguments));\n          return mClassList.methodChain ? ins : void 0;\n        },\n        remove: function() {\n          remove(list, element, Array.prototype.slice.call(arguments));\n          return mClassList.methodChain ? ins : void 0;\n        },\n        toggle: (token, force) => toggle(list, element, token, force),\n        replace: (token, newToken) => {\n          replace(list, element, token, newToken);\n          return mClassList.methodChain ? ins : void 0;\n        }\n      };\n    return ins;\n  })();\n}\n\nmClassList.methodChain = true;\n\nexport default mClassList;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/m-class-list/src/m-class-list.js"],"sourceRoot":""}